/*! full-video 0.2 | github.com/adamaveray/full-video | MIT */
!function(e){function o(i,t){this._init(i,e.extend({},o.defaults,t))}!window.ActiveXObject&&"ActiveXObject"in window?e.fn.fullVideo=function(){}:(e.extend(o,{defaults:{classLoading:"__loading",classLoaded:"__loaded",classPlaying:"__playing",templateHtml:'<div class="full-video__video"><div class="full-video__video__inner"></div></div>',ratio:"16:9",endPercent:.98,video:null,title:null,videoOptions:{},callbackLoaded:null,callbackEnd:null},defaultVideoOptions:{background:1,loop:1,autoplay:1},_library:"https://player.vimeo.com/api/player.js",_isLoading:!1,_loadCallbacks:[],getVimeo:function(i){var t,n=window.Vimeo;null==n?(this._loadCallbacks.push(i),this._isLoading||(this._isLoading=!0,e.getScript((t=this)._library,function(){for(var i=0;i<t._loadCallbacks.length;i++)t._loadCallbacks[i](n);t._loadCallbacks=[]}))):i(n)}}),e.extend(o.prototype,{$container:null,_$video:null,_options:null,_video:null,_ratio:null,_player:null,_title:null,_init:function(i,t){if(this.$container=i,this._options=t,this._video=i.data("video")||t.video,null==this._video)throw"Video ID not set";this._title=i.data("title")||t.title,this._ratio=function(i){if(2!==(i=String(i).split(":")).length)throw"Invalid ratio";var t=parseInt(i[0]),i=parseInt(i[1]);if(null==t||isNaN(t)||null==i||isNaN(i))throw"Invalid ratio";return i/t}(i.data("ratio")||t.ratio),this._$video=this._buildVideoContainer(),i.addClass(this._options.classLoading);var n=this;o.getVimeo(function(){n._$video.appendTo(n.$container),n._player=n._buildPlayer(n._$video.children()[0]),n._setupPlayer(n._player),e(window).on("resize",n.resize.bind(n))})},_buildVideoContainer:function(){var i=e.parseHTML(this._options.templateHtml,document);return e(i)},_buildPlayer:function(i){var t=e.extend({url:"https://player.vimeo.com/video/"+encodeURIComponent(this._video)},o.defaultVideoOptions,this._options.videoOptions);return new window.Vimeo.Player(i,t)},_setupPlayer:function(t){function i(){t.off("bufferend",i),t.off("timeupdate",i),n.activate(),window.setTimeout(function(){t.play()},1)}var n=this,e=(t.on("bufferend",i),t.on("timeupdate",i),t.on("ended",function(){t.play()}),this._options.endPercent),o=this._options.callbackEnd,a=function(i){i.percent>=e&&(t.off("timeupdate",a),o&&o.call(n))};t.on("timeupdate",a),this.resize()},activate:function(){this.$container.removeClass(this._options.classLoading).addClass(this._options.classLoaded),this._options.callbackLoaded&&this._options.callbackLoaded.call(this)},resize:function(){var i=this.$container.height()/this.$container.width()/this._ratio,t=100*i,i=1<i;this._$video.css({width:i?t+"%":"","margin-left":i?-(t-100)/2+"%":"","margin-top":i?"":(t-100)/4+"%"})}}),e.fn.fullVideo=function(n){return this.each(function(){var i=e(this),t=new o(i,n);i.data("full-video",t)})},e.FullVideo=o)}(window.jQuery);