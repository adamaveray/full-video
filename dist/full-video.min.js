/*! full-video 0.1 | github.com/adamaveray/full-video | MIT */
!function(n){function o(i,t){this._init(i,n.extend({},o.defaults,t))}!window.ActiveXObject&&"ActiveXObject"in window?n.fn.fullVideo=function(){}:(n.extend(o,{defaults:{classLoading:"__loading",classLoaded:"__loaded",classPlaying:"__playing",templateHtml:'<div class="full-video__video"><div class="full-video__video__inner"></div></div>',ratio:"16:9",endPercent:.98,video:null,title:null,videoOptions:{},callbackLoaded:null,callbackEnd:null},defaultVideoOptions:{background:1,loop:1,autoplay:1},_library:"https://player.vimeo.com/api/player.js",_isLoading:!1,_loadCallbacks:[],getVimeo:function(i){var t=window.Vimeo;if(null==t){if(this._loadCallbacks.push(i),!this._isLoading){this._isLoading=!0;var e=this;n.getScript(this._library,function(){for(var i=0;i<e._loadCallbacks.length;i++)e._loadCallbacks[i](t);e._loadCallbacks=[]})}}else i(t)}}),n.extend(o.prototype,{$container:null,_$video:null,_options:null,_video:null,_ratio:null,_player:null,_title:null,_init:function(i,t){if(this.$container=i,this._options=t,this._video=i.data("video")||t.video,null==this._video)throw"Video ID not set";this._title=i.data("title")||t.title,this._ratio=function(i){var t=String(i).split(":");if(2!==t.length)throw"Invalid ratio";var e=parseInt(t[0]),n=parseInt(t[1]);if(null==e||isNaN(e)||null==n||isNaN(n))throw"Invalid ratio";return n/e}(i.data("ratio")||t.ratio),this._$video=this._buildVideoContainer(),i.addClass(this._options.classLoading);var e=this;o.getVimeo(function(){e._$video.appendTo(e.$container),e._player=e._buildPlayer(e._$video.children()[0]),e._setupPlayer(e._player),n(window).on("resize",e.resize.bind(e))})},_buildVideoContainer:function(){var i=n.parseHTML(this._options.templateHtml,document);return n(i)},_buildPlayer:function(i){var t=n.extend({url:"https://player.vimeo.com/video/"+encodeURIComponent(this._video)},o.defaultVideoOptions,this._options.videoOptions);return new window.Vimeo.Player(i,t)},_setupPlayer:function(t){var e=this,i=function(){t.off("bufferend",i),t.off("timeupdate",i),e.activate(),window.setTimeout(function(){t.play()},1)};t.on("bufferend",i),t.on("timeupdate",i);t.on("ended",function(){t.play()});var n=this._options.endPercent,o=this._options.callbackEnd,a=function(i){i.percent>=n&&(t.off("timeupdate",a),o&&o.call(e))};t.on("timeupdate",a),this.resize()},activate:function(){this.$container.removeClass(this._options.classLoading).addClass(this._options.classLoaded),this._options.callbackLoaded&&this._options.callbackLoaded.call(this)},resize:function(){var i=this.$container.height()/this.$container.width()/this._ratio,t=100*i,e=1<i;this._$video.css({width:e?t+"%":"","margin-left":e?-(t-100)/2+"%":"","margin-top":e?"":(t-100)/4+"%"})}}),n.fn.fullVideo=function(e){return this.each(function(){var i=n(this),t=new o(i,e);i.data("full-video",t)})})}(window.jQuery);